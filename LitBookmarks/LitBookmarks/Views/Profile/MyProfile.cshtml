@model LitBookmarks.Models.ProfileViewModel
@{
    ViewBag.Title = "MyProfile";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<head>
    <link href="~/Styles/profileStyles.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


</head>

<img src="~/Images/profileLayoutImage.jpg" class="barImage" alt="John">
<div class="card">

    <div class="vcard-profile-pic">

        @if (Model.ImageData != null)
        {
            <img id ="img-style"src="@Url.Action("GetImage", "Profile", new {id = Model.Id})" />
        }
        else
        {
            <img id ="img-style"src="~/Images/defaultImage.png" />
        }
    </div>

    <div class="mycontainer">
        <h1> <span class="title">@Model.FirstName @Model.LastName</span></h1>
        <p class="title">Last Modified Date: @Model.LastActivityDateTime</p>
        <p class="title">About me: @Model.AboutMyself</p>
        <p class="title">Age: @Model.Age</p>
        <p class="title">Email: @Model.Email</p>
        
        @if (Model.FavoriteGenres.Count != 0)
        {
            <p class="title">
        My favorite genres:
                </p>
            for (int i = 0; i < @Model.FavoriteGenres.Count; i++)
            {
                <h2 class="label label-warning">@Model.FavoriteGenres[i].Name</h2>
            }

        }
        else
        {
            <p class="title">No favorite genres</p>

        }

    </div>
    <button class="button" data-toggle="collapse" data-target="#addGenre"> Add my favorite genres </button>
    <div id="addGenre" class="collapse">
        @using (Html.BeginForm("AddFavoriteGenre", "Profile", FormMethod.Post))
        {
            bool IsFound = false;
            if (Model.FavoriteGenres.Count == 0)
            {
                for (var i = 0; i < Model.AllGenres.Count(); i++)
                {
                    var genre = Model.AllGenres[i].Genre;
                    @Html.HiddenFor(model => model.AllGenres[i].Genre.GenreId)
                    @Html.HiddenFor(model => model.AllGenres[i].Genre.Name)
                    @Html.CheckBoxFor(model => model.AllGenres[i].Selected)
                    @Html.LabelFor(model => model.AllGenres[i].Genre.Name, genre.Name)
                    IsFound = true;
                }
            }
            if (Model.FavoriteGenres.Count > 0)
                {

                    for (var i = 0; i < Model.AllGenres.Count(); i++)
                    {
                        if (Model.FavoriteGenres.Find(x => x.GenreId.Equals(Model.AllGenres[i].Genre.GenreId)) == null)
                        {
                            var genre = Model.AllGenres[i].Genre;
                            @Html.HiddenFor(model => model.AllGenres[i].Genre.GenreId)
                            @Html.HiddenFor(model => model.AllGenres[i].Genre.Name)
                            @Html.CheckBoxFor(model => model.AllGenres[i].Selected)
                            @Html.LabelFor(model => model.AllGenres[i].Genre.Name, genre.Name)
                            IsFound = true;
                        }
                    }

                }
                if (IsFound)
                {
                    <input type="submit" value="Save" class="btn btn-success"/>
                }
                else
                {
                    <span>No genres to add</span>
                }
            
            
        }
        <div id="normal-button">
            @Html.ActionLink("Edit Profile", "Edit", "Profile", null, new { @class = "btn btn-warning" })

            @using (Html.BeginForm("Delete", "User"))
            {
                @Html.HiddenFor(x => Model.Id)
                <input type="submit"
                       class="btn btn-danger"
                       onclick="return confirm('Are you sure you wish to delete your profile?');"
                       value="Delete" />
            }
        </div>



</div>
    </div>
